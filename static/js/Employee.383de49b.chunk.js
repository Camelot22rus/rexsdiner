"use strict";(self.webpackChunkreact_pizza_v2=self.webpackChunkreact_pizza_v2||[]).push([[539],{6331:(e,s,t)=>{t.r(s),t.d(s,{default:()=>N});var a=t(3857),c=t(4309),l=t(7094),i=t(1648),n=t(5940),o=t(8743),r=t(2041),d=t(16),m=t(1180),p=t(3183),h=t(1410),u=t(2455),x=t(9520),j=t(668),v=t(4453);const N=()=>{const e=(0,c.wA)(),s=(0,x.j)(),{items:t,status:N}=((0,l.Zp)(),(0,c.d4)(i.x)),{totalPrice:_,items:y}=(0,c.d4)(n.V),g=(0,c.d4)(o.J2),b=(0,c.d4)(r.Kc),C=(0,c.d4)(r.mB),[f,w]=a.useState(""),[k,S]=a.useState(!0),[H,L]=a.useState(""),[M,P]=a.useState(!1),[V,z]=a.useState(!1),[B,E]=a.useState(""),Z=y.reduce((e,s)=>e+s.count,0);a.useEffect(()=>{(async()=>{await s((0,d.Tu)()),z(!0)})()},[s]);const $=Math.round(.3*_*100)/100,A=Math.round(.7*_*100)/100;a.useEffect(()=>{(async()=>{s((0,u.ys)({sortBy:"id",order:"asc",category:"",search:"",currentPage:"1"}))})()},[s]);const U=t.filter(e=>e.name&&e.name.toLowerCase().includes(f.toLowerCase())),W=U.reduce((e,s)=>{var t;const a=null!==(t=s.categorie)&&void 0!==t?t:"\u0411\u0435\u0437 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438";return e[a]||(e[a]=[]),e[a].push(s),e},{}),q=[],G=new Set;for(const a of U){var I;const e=null!==(I=a.categorie)&&void 0!==I?I:"\u0411\u0435\u0437 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438";G.has(e)||(G.add(e),q.push(e))}return V&&!b?(0,v.jsx)("div",{className:"employee-page",children:(0,v.jsxs)("div",{className:"employee-auth-prompt",children:[(0,v.jsx)("h2",{children:"Employee Access Required"}),(0,v.jsx)("p",{children:"Please log in to access the employee panel."}),(0,v.jsx)(j.zC,{isOpen:V&&!b,onClose:()=>{}})]})}):V?(0,v.jsxs)("div",{className:"employee-page",children:[(0,v.jsxs)("div",{className:"",children:[(0,v.jsxs)("div",{className:"employee-header",children:[(0,v.jsxs)("div",{className:"employee-header__top",children:[(0,v.jsx)("h2",{className:"employee-title",children:"\u041f\u0430\u043d\u0435\u043b\u044c \u0441\u043e\u0442\u0440\u0443\u0434\u043d\u0438\u043a\u0430"}),C&&(0,v.jsxs)("div",{className:"employee-user-info",children:[(0,v.jsxs)("span",{className:"employee-username",children:["\u0414\u043e\u0431\u0440\u043e \u043f\u043e\u0436\u0430\u043b\u043e\u0432\u0430\u0442\u044c, ",C.name," (",C.role,")"]}),(0,v.jsx)("button",{className:"employee-logout-btn",onClick:()=>{s((0,d.y4)())},children:"\u0412\u044b\u0439\u0442\u0438"})]})]}),(0,v.jsxs)("div",{className:"employee-header__controls",children:[(0,v.jsx)("div",{className:"employee-search",children:(0,v.jsx)("input",{type:"text",placeholder:"\u041f\u043e\u0438\u0441\u043a \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u043e\u0432...",value:f,onChange:e=>w(e.target.value),className:"employee-search__input"})}),(0,v.jsxs)("button",{className:"employee-orders-btn",onClick:()=>e((0,p.B)()),children:[(0,v.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,v.jsx)("path",{d:"M9 11H15M9 15H15M17 21H7C5.89543 21 5 20.1046 5 19V5C5 3.89543 5.89543 3 7 3H12.5858C12.851 3 13.1054 3.10536 13.2929 3.29289L19.7071 9.70711C19.8946 9.89464 20 10.149 20 10.4142V19C20 20.1046 19.1046 21 18 21H17ZM17 21V11H13V7H7V19H17Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,v.jsx)("span",{children:"\u0417\u0430\u043a\u0430\u0437\u044b"})]})]})]}),(0,v.jsx)("div",{className:"employee-content",children:(0,v.jsx)("div",{className:"product-list",children:"loading"===N?(0,v.jsx)("div",{className:"loading",children:"\u0417\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u044b..."}):q.map(s=>(0,v.jsxs)("div",{className:"category-section",children:[(0,v.jsx)("h3",{className:"category-title",children:s}),(0,v.jsx)("div",{className:"category-items",children:W[s].map(s=>{const t=(e=>{const s=y.find(s=>s.id===e);return s?s.count:0})(s.id);return(0,v.jsxs)("div",{className:"product-item",children:[(0,v.jsxs)("div",{className:"product-item__info",children:[(0,v.jsx)("h4",{className:"product-item__title",children:s.name}),(0,v.jsxs)("span",{className:"product-item__price",children:[s.price," $"]})]}),(0,v.jsxs)("div",{className:"product-item__controls",children:[t>0&&(0,v.jsx)("button",{className:"product-item__minus",onClick:()=>(s=>{const t=y.find(e=>e.id===s);t&&1===t.count?e((0,m.Ai)(s)):e((0,m.G8)(s))})(s.id),children:"\u2212"}),t>0&&(0,v.jsx)("span",{className:"product-item__count",children:t}),(0,v.jsx)("button",{className:"product-item__add",onClick:()=>(s=>{const t={id:s.id,title:s.name,price:s.price,imageUrl:s.imageUrl,count:0};e((0,m.B5)(t))})(s),children:"+"})]})]},s.id)})})]},s))})})]}),(0,v.jsxs)("div",{className:"employee-bottom-bar ".concat(k?"collapsed":""),style:{},children:[(0,v.jsx)("button",{className:"employee-toggle-btn",onClick:()=>{S(!k)},"aria-label":k?"Expand bottom bar":"Collapse bottom bar",children:(0,v.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"toggle-icon ".concat(k?"collapsed":""),children:(0,v.jsx)("path",{d:"M18 15l-6-6-6 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,v.jsxs)("div",{className:"employee-bottom-content",children:[(0,v.jsx)("div",{className:"employee-total",children:(0,v.jsxs)("div",{className:"employee-total__main",children:[(0,v.jsxs)("span",{className:"employee-total__count",children:[Z," \u043f\u043e\u0437\u0438\u0446\u0438\u0439"]}),(0,v.jsxs)("span",{className:"employee-total__price",children:[_," $"]})]})}),y.filter(e=>e.count>0).length>0&&(0,v.jsxs)("div",{className:"employee-cart-list",children:[(0,v.jsx)("h4",{className:"cart-list__title",children:"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u0435 \u0442\u043e\u0432\u0430\u0440\u044b:"}),(0,v.jsx)("div",{className:"cart-list__items",children:y.filter(e=>e.count>0).map(e=>{var s;const a=t.find(s=>s.id===e.id),c=(null===a||void 0===a?void 0:a.comboComponents)&&a.comboComponents.length>0;return(0,v.jsxs)("div",{className:"cart-list__item",children:[(0,v.jsxs)("div",{className:"cart-item__header",children:[(0,v.jsx)("span",{className:"cart-item__name",children:e.title}),(0,v.jsxs)("div",{className:"cart-item__details",children:[(0,v.jsxs)("span",{className:"cart-item__count",children:[e.count,"x"]}),(0,v.jsxs)("span",{className:"cart-item__price",children:[e.price*e.count," $"]})]})]}),c&&(0,v.jsxs)("div",{className:"cart-item__combo-components",children:[(0,v.jsx)("span",{className:"combo-components__label",children:"\u0412\u043a\u043b\u044e\u0447\u0430\u0435\u0442:"}),(0,v.jsx)("div",{className:"combo-components__list",children:null===(s=a.comboComponents)||void 0===s?void 0:s.map(e=>(0,v.jsx)("span",{className:"combo-component",children:e},e))})]})]},e.id)})})]}),(0,v.jsx)("div",{className:"employee-notes",children:(0,v.jsx)("input",{type:"text",placeholder:"\u0417\u0430\u043c\u0435\u0442\u043a\u0438 \u043a \u0437\u0430\u043a\u0430\u0437\u0443...",value:B,onChange:e=>E(e.target.value),className:"employee-notes__input"})}),(0,v.jsx)("button",{className:"employee-complete-btn ".concat(0===Z?"disabled":""),onClick:async()=>{if(Z>0){const a={items:y.filter(e=>e.count>0),totalPrice:_,totalCount:Z,thirtyPercent:$,seventyPercent:A,userId:null===C||void 0===C?void 0:C.id,notes:B};try{const t=await s((0,h.fS)(a));if(h.fS.fulfilled.match(t)){const s=t.payload;L("\u0417\u0430\u043a\u0430\u0437 #".concat(s.id," \u043d\u0430 \u0441\u0443\u043c\u043c\u0443 ").concat(s.totalPrice," $ (").concat(s.totalCount," \u043f\u043e\u0437\u0438\u0446\u0438\u0439) \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0443!")),P(!0),e((0,m.gw)()),E("")}else L("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438 \u0437\u0430\u043a\u0430\u0437\u0430. \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0435 \u0440\u0430\u0437."),P(!0)}catch(t){L("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438 \u0437\u0430\u043a\u0430\u0437\u0430. \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0435 \u0440\u0430\u0437."),P(!0)}}},disabled:0===Z,children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432 \u0437\u0430\u043a\u0430\u0437"})]})]}),g&&(0,v.jsx)(j.zZ,{}),(0,v.jsx)(j.UX,{message:H,isVisible:M,onClose:()=>{P(!1),L("")}})]}):(0,v.jsx)("div",{className:"employee-page employee-loading",children:(0,v.jsxs)("div",{className:"employee-auth-prompt",children:[(0,v.jsx)("h2",{children:"Loading"}),(0,v.jsx)("p",{children:"Checking authentication..."})]})})}}}]);
//# sourceMappingURL=Employee.383de49b.chunk.js.map