{"version":3,"file":"static/js/Employee.eda765d6.chunk.js","mappings":"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","sources":["pages/Employee.tsx"],"sourcesContent":["import React from \"react\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport { selectPizzaData } from \"../redux/pizza/selectors\";\r\nimport { selectCart } from \"../redux/cart/selectors\";\r\nimport { selectIsOrderHistoryOpen } from \"../redux/orders/selectors\";\r\nimport {\r\n  addItem,\r\n  minusItem,\r\n  removeItem,\r\n  clearItems,\r\n} from \"../redux/cart/slice\";\r\nimport { addOrder, toggleOrderHistory } from \"../redux/orders/slice\";\r\nimport { fetchPizzasFromJSON } from \"../redux/pizza/asyncActions\";\r\nimport { useAppDispatch } from \"../redux/store\";\r\nimport { OrderHistory } from \"../components\";\r\nimport { getNextOrderNumber } from \"../utils/getOrdersFromLS\";\r\n\r\nconst Employee: React.FC = () => {\r\n  const dispatch = useDispatch();\r\n  const appDispatch = useAppDispatch();\r\n  const { items, status } = useSelector(selectPizzaData);\r\n  const { totalPrice, items: cartItems } = useSelector(selectCart);\r\n  const isOrderHistoryOpen = useSelector(selectIsOrderHistoryOpen);\r\n\r\n  const [searchValue, setSearchValue] = React.useState(\"\");\r\n  const [isBottomBarCollapsed, setIsBottomBarCollapsed] = React.useState(true);\r\n\r\n  const totalCount = cartItems.reduce(\r\n    (sum: number, item: any) => sum + item.count,\r\n    0\r\n  );\r\n\r\n  // Calculate 30% and 70% breakdown\r\n  const thirtyPercent = Math.round(totalPrice * 0.3 * 100) / 100;\r\n  const seventyPercent = Math.round(totalPrice * 0.7 * 100) / 100;\r\n\r\n  React.useEffect(() => {\r\n    const getPizzas = async () => {\r\n      const sortBy = \"id\"; // Sort by ID instead of title\r\n      const order = \"asc\";\r\n      const category = \"\";\r\n      const search = \"\";\r\n      const currentPage = \"1\";\r\n\r\n      appDispatch(\r\n        fetchPizzasFromJSON({ sortBy, order, category, search, currentPage })\r\n      );\r\n    };\r\n\r\n    getPizzas();\r\n  }, [appDispatch]);\r\n\r\n  const filteredItems = items.filter((item) =>\r\n    item.title.toLowerCase().includes(searchValue.toLowerCase())\r\n  );\r\n\r\n  const onAddClick = (item: any) => {\r\n    const cartItem = {\r\n      id: item.id,\r\n      title: item.title,\r\n      price: item.price,\r\n      imageUrl: item.imageUrl,\r\n      count: 0,\r\n    };\r\n    dispatch(addItem(cartItem));\r\n  };\r\n\r\n  const onMinusClick = (id: string) => {\r\n    const cartItem = cartItems.find((item) => item.id === id);\r\n    if (cartItem && cartItem.count === 1) {\r\n      // If count will become 0, remove the item completely\r\n      dispatch(removeItem(id));\r\n    } else {\r\n      // Otherwise just decrease the count\r\n      dispatch(minusItem(id));\r\n    }\r\n  };\r\n\r\n  const getItemCount = (id: string) => {\r\n    const cartItem = cartItems.find((item) => item.id === id);\r\n    return cartItem ? cartItem.count : 0;\r\n  };\r\n\r\n  const onCompleteOrder = () => {\r\n    if (totalCount > 0) {\r\n      // Create order object with incremental ID\r\n      const orderNumber = getNextOrderNumber();\r\n      const order = {\r\n        id: orderNumber.toString(),\r\n        items: cartItems.filter((item) => item.count > 0),\r\n        totalPrice,\r\n        totalCount,\r\n        timestamp: new Date().toISOString(),\r\n        thirtyPercent,\r\n        seventyPercent,\r\n      };\r\n\r\n      // Add order to history\r\n      dispatch(addOrder(order));\r\n\r\n      alert(\r\n        `Заказ #${orderNumber} на сумму ${totalPrice} $ (${totalCount} позиций) добавлен в систему!`\r\n      );\r\n\r\n      // Clear the cart for the next order\r\n      dispatch(clearItems());\r\n    }\r\n  };\r\n\r\n  const toggleBottomBar = () => {\r\n    setIsBottomBarCollapsed(!isBottomBarCollapsed);\r\n  };\r\n\r\n  return (\r\n    <div className=\"employee-page\">\r\n      <div className=\"\">\r\n        <div className=\"employee-header\">\r\n          <h2 className=\"employee-title\">Панель сотрудника</h2>\r\n          <div className=\"employee-header__controls\">\r\n            <div className=\"employee-search\">\r\n              <input\r\n                type=\"text\"\r\n                placeholder=\"Поиск продуктов...\"\r\n                value={searchValue}\r\n                onChange={(e) => setSearchValue(e.target.value)}\r\n                className=\"employee-search__input\"\r\n              />\r\n            </div>\r\n            <button\r\n              className=\"employee-orders-btn\"\r\n              onClick={() => dispatch(toggleOrderHistory())}\r\n            >\r\n              <svg\r\n                width=\"20\"\r\n                height=\"20\"\r\n                viewBox=\"0 0 24 24\"\r\n                fill=\"none\"\r\n                xmlns=\"http://www.w3.org/2000/svg\"\r\n              >\r\n                <path\r\n                  d=\"M9 11H15M9 15H15M17 21H7C5.89543 21 5 20.1046 5 19V5C5 3.89543 5.89543 3 7 3H12.5858C12.851 3 13.1054 3.10536 13.2929 3.29289L19.7071 9.70711C19.8946 9.89464 20 10.149 20 10.4142V19C20 20.1046 19.1046 21 18 21H17ZM17 21V11H13V7H7V19H17Z\"\r\n                  stroke=\"currentColor\"\r\n                  strokeWidth=\"2\"\r\n                  strokeLinecap=\"round\"\r\n                  strokeLinejoin=\"round\"\r\n                />\r\n              </svg>\r\n              <span>Заказы</span>\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"employee-content\">\r\n          <div className=\"product-list\">\r\n            {status === \"loading\" ? (\r\n              <div className=\"loading\">Загружаем продукты...</div>\r\n            ) : (\r\n              filteredItems.map((item) => {\r\n                const itemCount = getItemCount(item.id);\r\n                return (\r\n                  <div key={item.id} className=\"product-item\">\r\n                    <div className=\"product-item__info\">\r\n                      <h4 className=\"product-item__title\">{item.title}</h4>\r\n                      <span className=\"product-item__price\">\r\n                        {item.price} $\r\n                      </span>\r\n                    </div>\r\n                    <div className=\"product-item__controls\">\r\n                      {itemCount > 0 && (\r\n                        <button\r\n                          className=\"product-item__minus\"\r\n                          onClick={() => onMinusClick(item.id)}\r\n                        >\r\n                          −\r\n                        </button>\r\n                      )}\r\n                      {itemCount > 0 && (\r\n                        <span className=\"product-item__count\">{itemCount}</span>\r\n                      )}\r\n                      <button\r\n                        className=\"product-item__add\"\r\n                        onClick={() => onAddClick(item)}\r\n                      >\r\n                        +\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                );\r\n              })\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Fixed bottom bar */}\r\n      <div\r\n        className={`employee-bottom-bar ${\r\n          isBottomBarCollapsed ? \"collapsed\" : \"\"\r\n        }`}\r\n        style={\r\n          {\r\n            // height: isBottomBarCollapsed ? \"90px\" : \"350px\",\r\n            // transition: \"height 0.3s ease\",\r\n          }\r\n        }\r\n      >\r\n        <button\r\n          className=\"employee-toggle-btn\"\r\n          onClick={toggleBottomBar}\r\n          aria-label={\r\n            isBottomBarCollapsed ? \"Expand bottom bar\" : \"Collapse bottom bar\"\r\n          }\r\n        >\r\n          <svg\r\n            width=\"20\"\r\n            height=\"20\"\r\n            viewBox=\"0 0 24 24\"\r\n            fill=\"none\"\r\n            xmlns=\"http://www.w3.org/2000/svg\"\r\n            className={`toggle-icon ${isBottomBarCollapsed ? \"collapsed\" : \"\"}`}\r\n          >\r\n            <path\r\n              d=\"M18 15l-6-6-6 6\"\r\n              stroke=\"currentColor\"\r\n              strokeWidth=\"2\"\r\n              strokeLinecap=\"round\"\r\n              strokeLinejoin=\"round\"\r\n            />\r\n          </svg>\r\n        </button>\r\n\r\n        <div className=\"employee-bottom-content\">\r\n          <div className=\"employee-total\">\r\n            <div className=\"employee-total__main\">\r\n              <span className=\"employee-total__count\">\r\n                {totalCount} позиций\r\n              </span>\r\n              <span className=\"employee-total__price\">{totalPrice} $</span>\r\n            </div>\r\n          </div>\r\n\r\n          {cartItems.filter((item) => item.count > 0).length > 0 && (\r\n            <div className=\"employee-cart-list\">\r\n              <h4 className=\"cart-list__title\">Добавленные товары:</h4>\r\n              <div className=\"cart-list__items\">\r\n                {cartItems\r\n                  .filter((item) => item.count > 0)\r\n                  .map((cartItem) => {\r\n                    // Find the original item to get combo components\r\n                    const originalItem = items.find(\r\n                      (item) => item.id === cartItem.id\r\n                    );\r\n                    const isCombo =\r\n                      originalItem?.comboComponents &&\r\n                      originalItem.comboComponents.length > 0;\r\n\r\n                    return (\r\n                      <div key={cartItem.id} className=\"cart-list__item\">\r\n                        <div className=\"cart-item__header\">\r\n                          <span className=\"cart-item__name\">\r\n                            {cartItem.title}\r\n                          </span>\r\n                          <div className=\"cart-item__details\">\r\n                            <span className=\"cart-item__count\">\r\n                              {cartItem.count}x\r\n                            </span>\r\n                            <span className=\"cart-item__price\">\r\n                              {cartItem.price * cartItem.count} $\r\n                            </span>\r\n                          </div>\r\n                        </div>\r\n                        {isCombo && (\r\n                          <div className=\"cart-item__combo-components\">\r\n                            <span className=\"combo-components__label\">\r\n                              Включает:\r\n                            </span>\r\n                            <div className=\"combo-components__list\">\r\n                              {originalItem.comboComponents?.map(\r\n                                (component: string) => (\r\n                                  <span\r\n                                    key={component}\r\n                                    className=\"combo-component\"\r\n                                  >\r\n                                    {component}\r\n                                  </span>\r\n                                )\r\n                              )}\r\n                            </div>\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    );\r\n                  })}\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          <button\r\n            className={`employee-complete-btn ${\r\n              totalCount === 0 ? \"disabled\" : \"\"\r\n            }`}\r\n            onClick={onCompleteOrder}\r\n            disabled={totalCount === 0}\r\n          >\r\n            Добавить в заказ\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Order History Modal */}\r\n      {isOrderHistoryOpen && <OrderHistory />}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Employee;\r\n"],"names":["Employee","dispatch","useDispatch","appDispatch","useAppDispatch","items","status","useSelector","selectPizzaData","totalPrice","cartItems","selectCart","isOrderHistoryOpen","selectIsOrderHistoryOpen","searchValue","setSearchValue","React","isBottomBarCollapsed","setIsBottomBarCollapsed","totalCount","reduce","sum","item","count","thirtyPercent","Math","round","seventyPercent","async","fetchPizzasFromJSON","sortBy","order","category","search","currentPage","getPizzas","filteredItems","filter","title","toLowerCase","includes","_jsxs","className","children","_jsx","type","placeholder","value","onChange","e","target","onClick","toggleOrderHistory","width","height","viewBox","fill","xmlns","d","stroke","strokeWidth","strokeLinecap","strokeLinejoin","map","itemCount","id","cartItem","find","getItemCount","price","removeItem","minusItem","onMinusClick","imageUrl","addItem","onAddClick","concat","style","toggleBottomBar","length","_originalItem$comboCo","originalItem","isCombo","comboComponents","component","onCompleteOrder","orderNumber","getNextOrderNumber","toString","timestamp","Date","toISOString","addOrder","alert","clearItems","disabled","OrderHistory"],"sourceRoot":""}